setwd("C:/DSA/FCD/BigDataRAzure/Cap18/Analise-Financeira-Dados-Hospitalares")
read.csv("dataset.csv")
dados = read.csv("dataset.csv")
library(dplyr)
library(sqldf)
View(dados)
nome_colunas = c("Idade", "Sexo", "TempoInternaçao", "Raça", "CustoInternaçao", "GrupoDiagnosticoRefinado")
names(dados) = nome_colunas
View(dados)
str(dados)
dados$Sexo = as.factor(dados$Sexo)
# Checando os tipos de dados
str(dados)
?as.factor()
View(dados)
dados$Sexo = as.factor(dados$Sexo, levels = c(0, 1), labels = c("Masculino", "Feminino"))
dados$Sexo = as.factor(dados$Sexo, labels = c("Masculino", "Feminino"))
dados = read.csv("dataset.csv")
# Renomeando as variáveis
nome_colunas = c("Idade", "Sexo", "TempoInternaçao", "Raça", "CustoInternaçao", "GrupoDiagnosticoRefinado")
names(dados) = nome_colunas
# Checando os tipos de dados
str(dados)
dados$Sexo = as.factor(dados$Sexo, labels = c("Masculino", "Feminino"))
dados$Sexo = as.factor(dados$Sexo, levels = c("Masculino", "Feminino"))
dados$Sexo = as.factor(dados$Sexo)
# Checando os tipos de dados
str(dados)
View(dados)
unique(dados$Sexo)
View(dados)
unique(dados$Raça)
is.na(dados$Raça)
is.na(dados)
sum(is.na(dados))
# Checando valores missing
sum(is.na(dados))
dim(dados)
dados = na.omit(dados)
dim(dados)
# Checando os tipos de dados
str(dados)
# Transformando a variável Raça para fator
unique(dados$Raça)
dados$Raça = as.factor(dados$Raça)
# Checando os tipos de dados
str(dados)
unique(dados$Idade)
unique(dados$TempoInternaçao)
unique(dados$CustoInternaçao)
unique(dados$GrupoDiagnosticoRefinado)
View(dados)
# Análise das variáveis numéricas com boxplot
boxplot(dados$Idade)
# Análise das variáveis numéricas com boxplot
boxplot(dados$TempoInternaçao)
# Análise das variáveis numéricas com boxplot
boxplot(dados$CustoInternaçao)
# Análise das variáveis numéricas com boxplot
boxplot(dados$GrupoDiagnosticoRefinado)
length(unique(dados$Idade))
length(unique(dados$TempoInternaçao))
length(unique(dados$CustoInternaçao))
length(unique(dados$GrupoDiagnosticoRefinado))
# Análise exploratória com linguagem SQL
?sqldf
sqldf("select * from dados", dados)
sqldf("select count(Raça) from dados", dados)
sqldf("select count(1) from dados", dados)
sqldf("select Raça from dados", dados)
sqldf("select Raça, count(*) from dados", dados)
sqldf("select Raça, count(1) from dados", dados)
sqldf("select Raça from dados", dados)
sqldf("select Idade, Raça, avg(Idade) from dados group by Raça", dados)
sqldf("select Idade, Raça, avg/(Idade/) from dados group by Raça", dados)
sqldf("select count(*) from dados", dados)
sqldf("select count(*) from dados")
sqldf("select count(Raça) from dados")
sqldf("select distinct Raça from dados")
sql("select avg(Idade) from dados group by idade")
sql("select avg(Idade) from dados")
sqldf("select avg(Idade) from dados")
sqldf("select avg(Idade) from dados group by Idade")
sqldf("select avg(Idade) from dados group by avg(Idade)")
sqldf("select avg(Idade) from dados")
sqldf("select Idade, count(*) from dados group by Idade desc")
sqldf("select Idade, count(*) from dados group by Idade")
sqldf("select Idade, count(*) from dados group by Idade DESC")
sqldf("select Idade, count(*) from dados group by Idade ASC")
sqldf("select Idade, count(*) from dados group by Idade")
sqldf("select var(Idade) from dados")
sqldf("select VAR(Idade) from dados")
sqldf("select var(Idade) from dados")
sqldf("select var_pop(Idade) from dados")
sqldf("select var_samp(Idade) from dados")
sqldf("select variance(Idade) from dados")
sqldf("select Idade, sum(CustoInternaçao) from dados group by Idade")
query = sqldf("select Idade, sum(CustoInternaçao) from dados group by Idade")
query
sqldf("select Idade, sum(CustoInternaçao) as Custo from dados group by Idade")
sqldf("select Idade, Custo from (select Idade, sum(CustoInternaçao) as Custo from dados group by Idade) group by Idade")
sqldf("select Idade, max(Custo) from (select Idade, sum(CustoInternaçao) as Custo from dados group by Idade) group by Idade")
sqldf("select Idade, max(Custo) from (select Idade, sum(CustoInternaçao) as Custo from dados group by Idade)")
sqldf("select Sexo, sum(CustoInternaçao) as Custo from dados group by Sexo")
sqldf("select Raça, avg(CustoInternaçao) as Custo from dados group by Raça")
sqldf("select Raça, avg(CustoInternaçao) as MediaCusto from dados group by Raça")
sqldf("select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade > 10 group by ")
sqldf("select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade > 10 group by Idade")
sqldf("select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade > 10")
sqldf("select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade > 10 group by Idade")
sqldf("select avg(CustoInternaçao) as MediaCusto from dados where Idade > 10")
sqldf("select Raça, avg(CustoInternaçao) as MediaCusto from dados group by Raça")
sqldf("select avg(CustoInternaçao) as MediaCusto from dados where Idade > 10")
sqldf("select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade>10 and MediaCusto>3000 group by Idade")
sqldf("select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade>10 group by Idade")
sqldf("Select Idade, MediaCusto from (select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade>10 group by Idade) where MediaCusto > 3000")
sqldf("select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade>10 group by Idade")
sqldf("select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade > 10 group by Idade")
sqldf("select avg(CustoInternaçao) as MediaCusto from dados where Idade > 10")
# Checando valores missing
sum(is.na(dados))
sqldf("select distinct Raça from dados")
sqldf("select Raça, count(Raça) from dados")
sqldf("select Raça, count(Raça) from dados group by Raça")
sqldf("select Raça, count(Raça) as NumeroRaças from dados group by Raça")
num_racas = sqldf("select Raça, count(Raça) as NumeroRaças from dados group by Raça")
num_racas
sqldf("select avg(Idade) from dados")
idade_media = sqldf("select avg(Idade) from dados")
idade_media
idade_moda = sqldf("select Idade, count(*) from dados group by Idade")
idade_moda
idade_moda = sqldf("select Idade, count(*) as Contagem from dados group by Idade order by Contagem desc")
idade_moda
idade_moda = sqldf("select Idade, count(*) as Contagem from dados group by Idade order by Contagem desc limit 1")
idade_moda
idade_variancia = sqldf("select variance(Idade) from dados")
idade_variancia
idade_variancia = sqldf("select variance(Idade) as Variancia from dados")
idade_variancia
gasto_total_idade = sqldf("select Idade, sum(CustoInternaçao) as Custo from dados group by Idade")
gasto_total_idade
gasto_total_idade_maior = sqldf("select Idade, max(Custo) from (select Idade, sum(CustoInternaçao) as Custo from dados group by Idade)")
gasto_total_idade_maior
gasto_total_idade_maior = sqldf("select Idade, max(Custo) as Custo from (select Idade, sum(CustoInternaçao) as Custo from dados group by Idade)")
gasto_total_idade_maior
gasto_total_genero = sqldf("select Sexo, sum(CustoInternaçao) as Custo from dados group by Sexo")
gasto_total_genero
gasto_medio_raca = sqldf("select Raça, avg(CustoInternaçao) as MediaCusto from dados group by Raça")
gasto_medio_raca
gasto_medio_idade_acima10 = sqldf("select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade > 10 group by Idade")
gasto_medio_idade_acima10
gasto_medio_idade_acima10_maior3k = sqldf("Select Idade, MediaCusto from (select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade>10 group by Idade) where MediaCusto > 3000")
gasto_medio_idade_acima10_maior3k
gasto_medio_idade_acima10_maior3k = sqldf("Select Idade, avg(CustoINternaçao) as MediaCusto from dados where MediaCusto > 10 group by Idade having MediaCusto > 3000")
gasto_medio_idade_acima10_maior3k = sqldf("Select Idade, avg(CustoIternaçao) as MediaCusto from dados where MediaCusto > 10 group by Idade having avg(CustoInternaçao) > 3000")
gasto_medio_idade_acima10_maior3k = sqldf("Select Idade, avg(CustoInternaçao) as MediaCusto from dados where MediaCusto > 10 group by Idade having avg(CustoInternaçao) > 3000")
gasto_medio_idade_acima10_maior3k = sqldf("Select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade > 10 group by Idade having avg(CustoInternaçao) > 3000")
gasto_medio_idade_acima10_maior3k
gasto_medio_idade_acima10_maior3k = sqldf("Select Idade, avg(CustoInternaçao) as MediaCusto from dados where Idade > 10 group by Idade having MediaCusto > 3000")
gasto_medio_idade_acima10_maior3k
hist(dados$Idade)
str(dados$Idade)
summary(dados$Idade)
resumo_idade = summary(as.factor(dados$Idade))
resumo_idade
resumo_idade
library(ggplot2)
ggplot(dados, aes(x = Idade)) +
geom_histogram()
ggplot(dados, aes(x = Idade)) +
geom_histogram() +
labs(title = "Distribuição da Idade")
ggplot(dados, aes(x = Idade)) +
geom_histogram() +
labs(title = "Distribuição da Idade") +
ylab(label = "")
ggplot(dados, aes(x = Idade)) +
geom_histogram() +
labs(title = "Distribuição da Idade") +
ylab(label = "")
resumo_idade
ggplot(dados, aes(x = Idade)) +
geom_histogram() +
labs(title = "Distribuição da Idade") +
ylab(label = "")
